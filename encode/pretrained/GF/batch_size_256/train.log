2024-11-22 05:05:43,344 - GF - INFO - Starting GF training with config:
2024-11-22 05:05:43,344 - GF - INFO - data_dir: /home/vllm/encode/cl_data/discreted_dataset/TRAIN
2024-11-22 05:05:43,344 - GF - INFO - dataset: PROTEINS
2024-11-22 05:05:43,344 - GF - INFO - graph_size_min: 2
2024-11-22 05:05:43,345 - GF - INFO - graph_size_max: 200
2024-11-22 05:05:43,345 - GF - INFO - graph_init_dim: 6
2024-11-22 05:05:43,345 - GF - INFO - filters: 100_100_100
2024-11-22 05:05:43,345 - GF - INFO - conv: gcn
2024-11-22 05:05:43,345 - GF - INFO - match: concat
2024-11-22 05:05:43,345 - GF - INFO - perspectives: 100
2024-11-22 05:05:43,345 - GF - INFO - match_agg: lstm
2024-11-22 05:05:43,345 - GF - INFO - hidden_size: 100
2024-11-22 05:05:43,345 - GF - INFO - drop_feature1: 0.3
2024-11-22 05:05:43,345 - GF - INFO - drop_feature2: 0.4
2024-11-22 05:05:43,345 - GF - INFO - drop_edge1: 0.2
2024-11-22 05:05:43,345 - GF - INFO - drop_edge2: 0.2
2024-11-22 05:05:43,345 - GF - INFO - epochs: 50
2024-11-22 05:05:43,345 - GF - INFO - batch_size: 256
2024-11-22 05:05:43,345 - GF - INFO - n_folds: 10
2024-11-22 05:05:43,345 - GF - INFO - test_split: 0.2
2024-11-22 05:05:43,345 - GF - INFO - patience: 30
2024-11-22 05:05:43,345 - GF - INFO - lr: 0.0001
2024-11-22 05:05:43,345 - GF - INFO - dropout: 0.1
2024-11-22 05:05:43,345 - GF - INFO - tau: 0.7
2024-11-22 05:05:43,345 - GF - INFO - global_flag: False
2024-11-22 05:05:43,345 - GF - INFO - global_agg: max_pool
2024-11-22 05:05:43,345 - GF - INFO - gpu_index: 0
2024-11-22 05:05:43,345 - GF - INFO - log_path: ../logs/
2024-11-22 05:05:43,345 - GF - INFO - seed: 42
2024-11-22 05:05:43,345 - GF - INFO - wandb_project: GF
2024-11-22 05:05:43,345 - GF - INFO - wandb_entity: 102201525-fuzhou-university
2024-11-22 05:05:43,345 - GF - INFO - wandb_run_name: GF-Dismantle
2024-11-22 05:05:43,345 - GF - INFO - wandb_log_freq: 100
2024-11-22 05:05:43,345 - GF - INFO - disable_wandb: False
2024-11-22 05:05:43,345 - GF - INFO - Using device: cuda:0
2024-11-22 05:06:21,145 - GF - INFO - Starting training procedure...
2024-11-22 05:06:21,159 - GF - INFO - Dataset split complete: 12828 train+val, 3207 test
2024-11-22 05:06:21,159 - GF - INFO - 
Trying parameters: {'lr': 0.0001, 'dropout': 0.1, 'tau': 0.5}
2024-11-22 05:06:21,160 - GF - INFO - Training fold 1/10
2024-11-22 06:36:52,148 - GF - INFO - Training fold 2/10
2024-11-22 08:13:45,316 - GF - INFO - Training fold 3/10
2024-11-22 09:07:03,934 - GF - INFO - Early stopping triggered at epoch 32
2024-11-22 09:07:03,942 - GF - INFO - Training fold 4/10
2024-11-22 10:25:41,417 - GF - INFO - Training fold 5/10
2024-11-22 11:43:58,451 - GF - INFO - Training fold 6/10
2024-11-22 13:03:22,028 - GF - INFO - Training fold 7/10
2024-11-22 14:23:04,047 - GF - INFO - Training fold 8/10
2024-11-22 15:42:48,366 - GF - INFO - Training fold 9/10
2024-11-22 16:59:36,022 - GF - INFO - Training fold 10/10
2024-11-22 17:49:43,468 - GF - INFO - Early stopping triggered at epoch 32
2024-11-22 17:49:43,476 - GF - INFO - 
Trying parameters: {'lr': 0.0001, 'dropout': 0.1, 'tau': 0.7}
2024-11-22 17:49:43,477 - GF - INFO - Training fold 1/10
2024-11-22 19:08:19,463 - GF - INFO - Training fold 2/10
2024-11-22 20:26:49,095 - GF - INFO - Training fold 3/10
2024-11-22 21:44:58,624 - GF - INFO - Training fold 4/10
2024-11-22 23:02:47,661 - GF - INFO - Training fold 5/10
2024-11-22 23:54:50,813 - GF - INFO - Early stopping triggered at epoch 33
2024-11-22 23:54:50,822 - GF - INFO - Training fold 6/10
2024-11-23 01:08:17,750 - GF - INFO - Early stopping triggered at epoch 47
2024-11-23 01:08:17,765 - GF - INFO - Training fold 7/10
2024-11-23 02:26:49,916 - GF - INFO - Training fold 8/10
2024-11-23 03:45:30,214 - GF - INFO - Training fold 9/10
2024-11-23 05:16:18,716 - GF - INFO - Training fold 10/10
2024-11-23 06:37:34,101 - GF - INFO - 
Trying parameters: {'lr': 0.0001, 'dropout': 0.3, 'tau': 0.5}
2024-11-23 06:37:34,102 - GF - INFO - Training fold 1/10
2024-11-23 07:57:14,424 - GF - INFO - Training fold 2/10
2024-11-23 09:27:05,953 - GF - INFO - Training fold 3/10
2024-11-23 10:48:06,871 - GF - INFO - Training fold 4/10
2024-11-23 12:05:42,153 - GF - INFO - Training fold 5/10
2024-11-23 13:23:29,384 - GF - INFO - Training fold 6/10
2024-11-23 14:42:16,999 - GF - INFO - Training fold 7/10
2024-11-23 15:59:55,167 - GF - INFO - Early stopping triggered at epoch 50
2024-11-23 15:59:55,176 - GF - INFO - Training fold 8/10
2024-11-23 17:17:07,494 - GF - INFO - Training fold 9/10
2024-11-23 18:34:35,819 - GF - INFO - Training fold 10/10
2024-11-23 19:52:08,688 - GF - INFO - 
Trying parameters: {'lr': 0.0001, 'dropout': 0.3, 'tau': 0.7}
2024-11-23 19:52:08,689 - GF - INFO - Training fold 1/10
2024-11-23 21:09:46,511 - GF - INFO - Training fold 2/10
2024-11-23 22:27:52,612 - GF - INFO - Training fold 3/10
2024-11-23 23:45:29,909 - GF - INFO - Training fold 4/10
2024-11-24 01:02:08,189 - GF - INFO - Training fold 5/10
2024-11-24 02:19:22,211 - GF - INFO - Training fold 6/10
2024-11-24 03:36:24,313 - GF - INFO - Training fold 7/10
2024-11-24 04:52:25,849 - GF - INFO - Early stopping triggered at epoch 49
2024-11-24 04:52:25,857 - GF - INFO - Training fold 8/10
2024-11-24 06:09:48,808 - GF - INFO - Training fold 9/10
2024-11-24 06:57:23,866 - GF - INFO - Early stopping triggered at epoch 31
2024-11-24 06:57:23,875 - GF - INFO - Training fold 10/10
2024-11-24 08:15:31,389 - GF - INFO - 
Trying parameters: {'lr': 0.001, 'dropout': 0.1, 'tau': 0.5}
2024-11-24 08:15:31,390 - GF - INFO - Training fold 1/10
2024-11-24 09:33:24,331 - GF - INFO - Training fold 2/10
2024-11-24 10:51:03,614 - GF - INFO - Training fold 3/10
2024-11-24 12:10:17,416 - GF - INFO - Training fold 4/10
2024-11-24 13:29:29,283 - GF - INFO - Training fold 5/10
2024-11-24 14:26:59,090 - GF - INFO - Early stopping triggered at epoch 37
2024-11-24 14:26:59,099 - GF - INFO - Training fold 6/10
2024-11-24 15:45:14,843 - GF - INFO - Training fold 7/10
2024-11-24 17:02:48,527 - GF - INFO - Training fold 8/10
2024-11-24 18:43:14,020 - GF - INFO - Early stopping triggered at epoch 41
2024-11-24 18:43:14,030 - GF - INFO - Training fold 9/10
2024-11-24 20:55:19,725 - GF - INFO - Training fold 10/10
2024-11-24 22:26:09,838 - GF - INFO - 
Trying parameters: {'lr': 0.001, 'dropout': 0.1, 'tau': 0.7}
2024-11-24 22:26:09,839 - GF - INFO - Training fold 1/10
2024-11-24 23:45:21,802 - GF - INFO - Training fold 2/10
2024-11-25 00:42:09,917 - GF - INFO - Early stopping triggered at epoch 36
2024-11-25 00:42:09,926 - GF - INFO - Training fold 3/10
2024-11-25 02:05:07,282 - GF - INFO - Training fold 4/10
2024-11-25 03:37:42,097 - GF - INFO - Training fold 5/10
2024-11-25 05:06:25,616 - GF - INFO - Training fold 6/10
2024-11-25 06:29:12,675 - GF - INFO - Training fold 7/10
2024-11-25 08:14:35,101 - GF - INFO - Training fold 8/10
2024-11-25 09:28:05,637 - GF - INFO - Early stopping triggered at epoch 36
2024-11-25 09:28:05,645 - GF - INFO - Training fold 9/10
2024-11-25 11:18:40,229 - GF - INFO - Early stopping triggered at epoch 45
2024-11-25 11:18:40,238 - GF - INFO - Training fold 10/10
2024-11-25 12:41:48,193 - GF - INFO - 
Trying parameters: {'lr': 0.001, 'dropout': 0.3, 'tau': 0.5}
2024-11-25 12:41:48,194 - GF - INFO - Training fold 1/10
2024-11-25 13:59:39,350 - GF - INFO - Training fold 2/10
2024-11-25 15:16:48,572 - GF - INFO - Training fold 3/10
2024-11-25 17:03:21,416 - GF - INFO - Training fold 4/10
2024-11-25 19:05:24,738 - GF - INFO - Training fold 5/10
2024-11-25 20:13:41,040 - GF - INFO - Early stopping triggered at epoch 37
2024-11-25 20:13:41,049 - GF - INFO - Training fold 6/10
2024-11-25 21:45:03,614 - GF - INFO - Training fold 7/10
2024-11-25 23:37:46,903 - GF - INFO - Training fold 8/10
2024-11-26 01:03:23,002 - GF - INFO - Early stopping triggered at epoch 41
2024-11-26 01:03:23,009 - GF - INFO - Training fold 9/10
2024-11-26 02:29:02,218 - GF - INFO - Training fold 10/10
2024-11-26 04:13:05,269 - GF - INFO - 
Trying parameters: {'lr': 0.001, 'dropout': 0.3, 'tau': 0.7}
2024-11-26 04:13:05,270 - GF - INFO - Training fold 1/10
2024-11-26 05:54:21,149 - GF - INFO - Training fold 2/10
2024-11-26 10:21:20,934 - GF - INFO - Training fold 3/10
2024-11-26 13:35:21,825 - GF - INFO - Training fold 4/10
2024-11-26 14:24:27,006 - GF - INFO - Early stopping triggered at epoch 31
2024-11-26 14:24:27,015 - GF - INFO - Training fold 5/10
2024-11-26 15:44:11,204 - GF - INFO - Training fold 6/10
2024-11-26 18:00:55,149 - GF - INFO - Training fold 7/10
2024-11-26 19:18:46,761 - GF - INFO - Training fold 8/10
2024-11-26 20:36:48,530 - GF - INFO - Training fold 9/10
2024-11-26 21:55:32,034 - GF - INFO - Training fold 10/10
2024-11-26 23:13:33,888 - GF - INFO - 
Hyperparameter search results:
2024-11-26 23:13:33,889 - GF - INFO - Params: {'lr': 0.0001, 'dropout': 0.1, 'tau': 0.5}, Mean loss: 5.942475 ± 0.048375
2024-11-26 23:13:33,889 - GF - INFO - Params: {'lr': 0.0001, 'dropout': 0.1, 'tau': 0.7}, Mean loss: 5.925134 ± 0.052241
2024-11-26 23:13:33,889 - GF - INFO - Params: {'lr': 0.0001, 'dropout': 0.3, 'tau': 0.5}, Mean loss: 5.913993 ± 0.044732
2024-11-26 23:13:33,889 - GF - INFO - Params: {'lr': 0.0001, 'dropout': 0.3, 'tau': 0.7}, Mean loss: 5.931278 ± 0.050139
2024-11-26 23:13:33,889 - GF - INFO - Params: {'lr': 0.001, 'dropout': 0.1, 'tau': 0.5}, Mean loss: 5.879149 ± 0.056608
2024-11-26 23:13:33,889 - GF - INFO - Params: {'lr': 0.001, 'dropout': 0.1, 'tau': 0.7}, Mean loss: 5.895398 ± 0.062881
2024-11-26 23:13:33,889 - GF - INFO - Params: {'lr': 0.001, 'dropout': 0.3, 'tau': 0.5}, Mean loss: 5.863298 ± 0.065924
2024-11-26 23:13:33,890 - GF - INFO - Params: {'lr': 0.001, 'dropout': 0.3, 'tau': 0.7}, Mean loss: 5.911876 ± 0.077226
2024-11-26 23:13:34,602 - GF - INFO - 
Training final model with best parameters: {'lr': 0.001, 'dropout': 0.3, 'tau': 0.5}
2024-11-27 00:35:42,137 - GF - INFO - Final test loss: 5.988961
2024-11-27 00:35:42,139 - GF - INFO - Training completed!
2024-11-27 00:35:42,139 - GF - INFO - Cross-validation loss: 5.907825 ± 0.025160
2024-11-27 00:35:42,139 - GF - INFO - Test loss: 5.988961
